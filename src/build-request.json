{
  "kind": "build_request",
  "title": "Emit gpioset -c gpiochip0 <id>=<state> on button press/release",
  "projectName": "GPIO Control Panel",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Change button interaction event emission so that the emitted command string (event.value) uses the format `gpioset -c gpiochip0 #=$`, where `#` is the button's numeric code (1–16) and `$` is `1` when pressed and `0` when released.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "recent-messages-4"
        ],
        "quotes": [
          "change the output signal to (gpioset -cgpiochip0 #=$). where #= the id of the button and $=1 when pressed and 0 when released."
        ]
      },
      "acceptanceCriteria": [
        "When a button control is pressed in interact mode, the emitted event.value equals `gpioset -c gpiochip0 <N>=1` where <N> is that button’s code (derived from its configured 1–16 code).",
        "When the same button is released (pointer up/cancel/leave and keyboard keyup/blur paths), the emitted event.value equals `gpioset -c gpiochip0 <N>=0` for the same <N>.",
        "No `gpioset` command sequence based on 4-bit pin mappings is emitted for button press/release after this change."
      ]
    },
    {
      "id": "REQ-2",
      "text": "Derive the `#` value for the new gpioset command from the existing button code configuration (the button’s 1–16 code) rather than the control's textual layout id, and ensure the command is only emitted when the derived code is valid (1–16).",
      "target": "frontend",
      "source": {
        "messageIds": [
          "recent-messages-4"
        ],
        "quotes": [
          "#= the id of the button"
        ]
      },
      "acceptanceCriteria": [
        "For button controls, the emitted command uses a numeric id between 1 and 16 (inclusive).",
        "If a button’s configured code cannot be derived/validated as 1–16, the press/release does not emit a gpioset command and logs a warning to the console."
      ]
    },
    {
      "id": "REQ-3",
      "text": "Update the gpioset command generation utility so it can generate the single-command format `gpioset -c gpiochip0 <id>=<state>` for button press/release, and remove or stop using the old 4-bit-to-multiple-pin mapping generator for button events.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "recent-messages-4"
        ],
        "quotes": [
          "change the output signal to (gpioset -cgpiochip0 #=$)"
        ]
      },
      "acceptanceCriteria": [
        "There is a reusable helper that returns exactly `gpioset -c gpiochip0 <id>=<state>` (with a space after `gpioset`, and `-c gpiochip0` present).",
        "ControlRenderer (button press/release paths) uses the new helper to build the emitted value."
      ]
    },
    {
      "id": "REQ-4",
      "text": "Update Raspberry Pi bash runner documentation to reflect that button events now emit single `gpioset -c gpiochip0 <id>=<state>` commands on press and release.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "recent-messages-4"
        ],
        "quotes": [
          "change the output signal to (gpioset -cgpiochip0 #=$)"
        ]
      },
      "acceptanceCriteria": [
        "`frontend/docs/rpi-bash-runner.md` mentions the new emitted command format for button events, including that `state` is 1 on press and 0 on release.",
        "The documentation does not claim button events emit 4-line pin-mapping sequences for 4-bit codes."
      ]
    }
  ],
  "constraints": [
    "Backend must remain a single Motoko actor in backend/main.mo.",
    "Do not edit any files under frontend/src/components/ui or any paths listed as immutable in SYSTEM_CONTEXT."
  ],
  "nonGoals": [
    "Changing the backend event schema or adding new backend canister methods.",
    "Adding new authentication methods beyond Internet Identity.",
    "Redesigning non-button controls (toggle/slider/radio/dial) emission formats unless required for the new button press/release command format."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}